package org.example.entity;

import java.sql.SQLException;
import java.util.List;

/**
 * Интерфейс сервиса для управления заметками пользователей.
 * <p>
 * Определяет контракт для выполнения операций с заметками: создание, чтение,
 * обновление, удаление, а также дополнительные операции для работы с тегами.
 * </p>
 * <p>
 * Данный интерфейс спроектирован для использования в боте Telegram и обеспечивает
 * всю необходимую функциональность для управления заметками пользователей
 * с возможностью фильтрации по тегам и организации данных.
 * </p>
 *
 * @since 1.0
 */
public interface NoteService {
    /**
     * Добавляет новую заметку для пользователя.
     *
     * @param userId идентификатор пользователя
     * @param text текст заметки, который может содержать теги в формате #тег
     * @throws SQLException если произошла ошибка при сохранении в базу данных
     */
    void addNote(long userId, String text) throws SQLException;

    /**
     * Получает реальный идентификатор заметки по её порядковому номеру для пользователя.
     * <p>
     * Порядковые номера начинаются с 1 для первой заметки в списке.
     * </p>
     *
     * @param userId идентификатор пользователя
     * @param index порядковый номер заметки (начиная с 1)
     * @return реальный идентификатор заметки в базе данных или null, если заметка не найдена
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    Integer getNoteIdByIndex(long userId, int index) throws SQLException;

    /**
     * Получает текст заметки по её идентификатору.
     *
     * @param userId идентификатор пользователя
     * @param noteId идентификатор заметки
     * @return текст заметки или null, если заметка не найдена
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    String getNoteTextById(long userId, int noteId) throws SQLException;

    /**
     * Получает список тегов для указанной заметки.
     *
     * @param noteId идентификатор заметки
     * @return список тегов, связанных с заметкой (пустой список, если тегов нет)
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    List<String> getTagsForNote(int noteId) throws SQLException;

    /**
     * Обновляет текст существующей заметки.
     * <p>
     * При обновлении текста автоматически обрабатываются теги в новом тексте,
     * обновляя соответствующие связи в базе данных.
     * </p>
     *
     * @param userId идентификатор пользователя
     * @param noteId идентификатор заметки
     * @param newText новый текст заметки
     * @throws SQLException если произошла ошибка при обновлении данных
     */
    void updateNote(long userId, int noteId, String newText) throws SQLException;

    /**
     * Удаляет заметку пользователя по её идентификатору.
     * <p>
     * При удалении заметки также удаляются все связанные с ней теги.
     * </p>
     *
     * @param userId идентификатор пользователя
     * @param noteId идентификатор заметки для удаления
     * @throws SQLException если произошла ошибка при удалении данных
     */
    void deleteNote(long userId, int noteId) throws SQLException;

    /**
     * Получает список всех заметок пользователя, отфильтрованных по указанному тегу.
     *
     * @param userId идентификатор пользователя
     * @param tag тег для фильтрации в формате "#тег"
     * @return список текстов заметок с указанным тегом
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    List<String> getNotesByTag(long userId, String tag) throws SQLException;

    /**
     * Получает список всех тегов пользователя с количеством заметок для каждого тега.
     * <p>
     * Каждый элемент списка имеет формат "#тег (количество)".
     * </p>
     *
     * @param userId идентификатор пользователя
     * @return список строк с тегами и количеством заметок
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    List<String> getAllUserTagsWithCounts(long userId) throws SQLException;

    /**
     * Получает список всех заметок пользователя.
     * <p>
     * Заметки возвращаются в порядке убывания даты создания (последние добавленные - первые).
     * </p>
     *
     * @param userId идентификатор пользователя
     * @return список текстов всех заметок пользователя
     * @throws SQLException если произошла ошибка при обращении к базе данных
     */
    List<String> getAllNotes(long userId) throws SQLException;
}